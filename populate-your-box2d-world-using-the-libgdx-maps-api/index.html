<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/touch-icon-144-precomposed.png"/><title>Populate your Box2D world using the libgdx maps API · David Saltares</title><meta name="robots" content="index,follow"/><meta name="description" content="Engineering Leadership &amp; Software Development"/><meta property="og:title" content="Populate your Box2D world using the libgdx maps API · David Saltares"/><meta property="og:description" content="Engineering Leadership &amp; Software Development"/><meta property="og:url" content="https://saltares.com/populate-your-box2d-world-using-the-libgdx-maps-api"/><meta property="og:type" content="website"/><link rel="canonical" href="https://saltares.com/populate-your-box2d-world-using-the-libgdx-maps-api"/><meta name="keywords" content=""/><meta name="next-head-count" content="12"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/d3d4cc303d9c1080.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/d3d4cc303d9c1080.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-7671224c423a1e1f.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-66d32731bdd20e83.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-41a9ee3ebe735abe.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-75760b031d352622.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/c16184b3-5eed107b4bbcea31.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/2cca2479-0d4bcd71a6a0316a.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/252-2454d8293e83336b.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/167-6fe50976be6d0e53.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/962-ea29c7731d832d32.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/373-f5166c707bca4ed3.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-81b48131ea6e98cc.js" defer="" crossorigin=""></script><script src="/_next/static/9JA16_iB_mzyhbFzPaViV/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/9JA16_iB_mzyhbFzPaViV/_ssgManifest.js" defer="" crossorigin=""></script><style data-href="https://fonts.googleapis.com/css2?family=PT+Sans:wght@400;700&display=swap">@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79P0Y.woff) format('woff')}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh4Oo.woff) format('woff')}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0-ExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0aExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0yExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0KExcOPIDU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0OOtLR8a8zILig.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0OqtLR8a8zILig.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0OCtLR8a8zILig.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0O6tLR8a8zI.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="flex flex-col md:flex-row font-sans text-xl w-full"><aside class="md:max-w-[360px] bg-primary px-10 py-10 text-white text-xl md:fixed md:top-0 md:left-0 md:h-full flex flex-col justify-end items-center md:items-start"><div><a href="/"><div class="mb-5"><img alt="profile picture" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="rounded-full" style="color:transparent" src="/img/profile.webp"/></div><h1 class="text-white font-bold text-4xl leading-10">David Saltares</h1></a></div><p class="text-contentLight text-2xl mb-5 leading-9 text-center md:text-left">Engineering Leadership &amp; Software Development</p><div class="mb-5 font-base"><button class="ml-onclick-form" onclick="ml('show', '646AL4', true)">✉️ Subscribe</button></div><nav><ul class="mb-5 flex flex-col items-center md:items-start list-none pl-0"><li class="leading-7"><a href="/">Blog</a></li><li class="leading-7"><a href="/about-me/">About</a></li><li class="leading-7"><a href="/apps-tools/">Apps &amp; Tools</a></li><li class="leading-7"><a href="/game-jams/">Game Jams</a></li><li class="leading-7"><a href="/games/">Games</a></li><li class="leading-7"><a href="/libgdx-cross-platform-game-development-cookbook/">Libgdx Cookbook</a></li></ul></nav><ul class="mb-5 list-none pl-0"><li class="inline"><a aria-label="Github profile" href="https://github.com/dsaltares"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="square-github" class="svg-inline--fa fa-square-github text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg></a></li><li class="inline"><a aria-label="Linkedin profile" href="https://www.linkedin.com/in/davidsaltares/"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li class="inline"><a aria-label="Twitter profile" href="https://twitter.com/dsaltares"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="square-twitter" class="svg-inline--fa fa-square-twitter text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-48.9 158.8c.2 2.8.2 5.7.2 8.5 0 86.7-66 186.6-186.6 186.6-37.2 0-71.7-10.8-100.7-29.4 5.3.6 10.4.8 15.8.8 30.7 0 58.9-10.4 81.4-28-28.8-.6-53-19.5-61.3-45.5 10.1 1.5 19.2 1.5 29.6-1.2-30-6.1-52.5-32.5-52.5-64.4v-.8c8.7 4.9 18.9 7.9 29.6 8.3a65.447 65.447 0 0 1-29.2-54.6c0-12.2 3.2-23.4 8.9-33.1 32.3 39.8 80.8 65.8 135.2 68.6-9.3-44.5 24-80.6 64-80.6 18.9 0 35.9 7.9 47.9 20.7 14.8-2.8 29-8.3 41.6-15.8-4.9 15.2-15.2 28-28.8 36.1 13.2-1.4 26-5.1 37.8-10.2-8.9 13.1-20.1 24.7-32.9 34z"></path></svg></a></li><li class="inline"><a aria-label="RSS feed" href="https://saltares.com/index.xml"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="square-rss" class="svg-inline--fa fa-square-rss text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm64 120c0 17.7-14.3 32-32 32s-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32z"></path></svg></a></li><li class="inline"><a rel="me" href="https://fosstodon.org/@dsaltares"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="mastodon" class="svg-inline--fa fa-mastodon text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></path></svg></a></li></ul><p class="text-contentLight text-lg">© 2024 David Saltares.</p></aside><div class="md:max-w-[360px] w-full hidden md:block flex-grow-0 flex-shrink-0"></div><div class="flex flex-col main-content"><main class="w-full max-w-[720px] pr-4 py-10 pl-5 md:py-20 md:pl-20"><article class="text-content mb-10"><div><a href="/populate-your-box2d-world-using-the-libgdx-maps-api/"><h1 class="font-bold text-4xl mb-2 text-primary">Populate your Box2D world using the libgdx maps API</h1></a><p class="flex text-contentLight mb-1">Mar 9 2013 · 7 min read<span> · </span><a class="text-contentLink" href="/populate-your-box2d-world-using-the-libgdx-maps-api/#disqus_thread">Comments</a></p><div class="mb-3"><div class="flex flex-row gap-1"><a class="px-2 py-1 bg-slate-900 text-white rounded font-bold text-sm" href="/categories/games-development/">Games development</a></div></div></div><p>This text proposes an effective approach to painlessly create static collidable geometry in 2D levels with the help of Box2D and the new libgdx maps API.</p>
<p>All the source code is available for direct download below the post.</p>
<h3>New libgdx maps API</h3>
<p>The mighty libgdx library saw itself to yet another addition a couple of weeks ago, <a class="text-contentLink text-lg" href="http://www.badlogicgames.com/wordpress/?p=2870">a shiny brand new maps API</a>. Nex and me had been working on it for a while and people seem to be quite happy with it. Actually, by now, loads of folks have contributed too, which is kind of the beauty of open source, isn&#x27;t it? You might as well read the <a class="text-contentLink text-lg" href="http://code.google.com/p/libgdx/wiki/GraphicsTileMaps?ts=1361648294&amp;updated=GraphicsTileMaps">wiki page</a> and check out the <a class="text-contentLink text-lg" href="https://code.google.com/p/libgdx/wiki/GraphicsTileMaps?ts=1361648294&amp;updated=GraphicsTileMaps#Examples">sample code</a>, luckily enough, there&#x27;s plenty which is not always the case.</p>
<p>It primarily focuses on modelling how maps data is represented as well as in providing a way of easily implementing loaders and renderers for specific formats. The API comes with built in loaders and renderers for the <a class="text-contentLink text-lg" href="http://www.mapeditor.org/">TMX</a>, <a class="text-contentLink text-lg" href="http://tide.codeplex.com/">Tide</a> and <a class="text-contentLink text-lg" href="http://gleed2d.codeplex.com/">Gleed</a> formats. However, the latter might be deprecated at some point in the future due its absolute paths horribleness. Believe me, I&#x27;ve tried to work my way around it but there is just no elegant solution. Although there hasn&#x27;t been any releases since it&#x27;s inclusion, it&#x27;s accessible in the <a class="text-contentLink text-lg" href="http://libgdx.badlogicgames.com/nightlies/">nightly builds</a>. For those interested in the implementation, please go to the Github repository.</p>
<img class="mb-1" src="/img/wp/maps-api-300x125.webp" alt="maps-api-300x125.png"/>
<p>Take this cutie as an example, <a class="text-contentLink text-lg" href="https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/superkoalio/SuperKoalio.java">a minimalistic platformer using the new API</a> in just under 300 lines.</p>
<img class="mb-1" src="/img/wp/koalio-300x216.webp" alt="koalio-300x216.png"/>
<p>Enjoy.</p>
<h3>Use your level editor to place world physics geometry</h3>
<p>Let&#x27;s say you&quot;re working on a 2D game which mechanics require some sort of collision detection. Most likely, you&quot;ll be leveraging an editor such as Tiled or Gleed to boost your level creation process. How are you planning to implement collision detection in a way it doesn&#x27;t become an excruciating pain in the ass to maintain? Can we also make it efficient, please?</p>
<blockquote>
<p>At last! After all, this is what the article is really about.</p>
</blockquote>
<p>If you&quot;re going for tile based levels, you could add properties to the map to determine tiles walkability, a perfectly valid approach when presented with just a bunch of tiles. However, adding or changing tiles can become tedious really soon. Why don&#x27;t you take advantage of Box2D collision detection algorithms and <a class="text-contentLink text-lg" href="http://en.wikipedia.org/wiki/Space_partitioning">space partitioning</a> techniques? No worries, you could do so regardless of the need of running a real time physics simulation, just create the bodies, move them according to the game logic and query the world for intersections without stepping it. In case of dealing with a physics based game, then, by all means, make full use of Box2D.</p>
<img class="mb-1" src="/img/wp/tiled-caveman-300x154.webp" alt="tiled-caveman-300x154.png"/>
<p>I&quot;m going to assume basic knowledge of this popular physics library, if you don&#x27;t consider yourself minimally familiar with it, please <a class="text-contentLink text-lg" href="http://box2d.org/manual.pdf">take some time to get the basics</a>.</p>
<p>Alright, your textures are all set in your level and it looks stunningly beautiful! Sadly, you lack any kind of collision data. A good practice is to create a separate layer named <em>&quot;physics&quot;</em> or similar for sanity reasons. Now you can start placing shapes (rectangles, circles, polygons or polylines) so they adjust to the non walkable areas. Here&#x27;s an example in my WIP casual abduction game.</p>
<img class="mb-1" src="/img/wp/gleed-abduction-collisions-300x158.webp" alt="gleed-abduction-collisions-300x158.png"/>
<p>As you could have guessed, having thousands of shapes won&#x27;t do your game&#x27;s performance any favours. It&quot;d be a good idea to keep the shape count under control while preserving a decent granularity. Ideally, the editor would have a <em>&quot;generate physics&quot;</em> option that would automatically create collision data from a texture layer using <a class="text-contentLink text-lg" href="http://www.imageprocessingplace.com/downloads_V3/root_downloads/tutorials/contour_tracing_Abeer_George_Ghuneim/alg.html">contour tracing</a>. Sadly, that&#x27;s not the case in the state of the art open source software we have today.</p>
<p>Don&#x27;t forget to hit <em>&quot;save&quot;</em>.</p>
<h3>Create bodies from your level data &gt; My level has collidable static geometry data, how do I get that in my game?</h3>
<p>To tackle that problem I implemented a simple class named <em>MapBodyManager</em> with the following interface.</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">public class MapBodyManager {
    public MapBodyManager(World world, int unitsPerPixel, String materialsFile);
    public void createPhysics(Map map, String layerName);
    public void destroyPhysics();
}</code></pre></div>
<p>I believe it to be simple enough but I&quot;ll explain the details just in case. The constructor takes the Box2D world so it knows where to dump the new bodies into and where to delete them from later on. Most level editors work in pixels, while Box2D measures stuff in metres (take that imperial system!), hence the need for the <em>unitsPerPixel</em> conversion rate. We&quot;ll get to the materials stuff in just a minute.</p>
<p>Once your level is loaded, you just need to do this.</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">MapBodyManager mapBodyManager = new MapBodyManager(world, 1.0f, Gdx.files.internal(&amp;quot;data/materials.json&amp;quot;));
Map map = assetManager.get(&amp;quot;data/level.xml&amp;quot;, Map.class);
mapBodyManager.createPhysics(map, &amp;quot;physics&amp;quot;);</code></pre></div>
<p>This will automatically create a static body per shape in your <em>&quot;physics&quot;</em> layer as shown in the screenshot below.</p>
<img class="mb-1" src="/img/wp/abduction.webp" alt="abduction.jpg"/>
<p>So the player heroically beats the level and makes it to the next one. You surely will want to get rid of all those bodies (reference to murder not intended) before adding any more. Interestingly enough, our handy <em>MapBodyManager</em> keeps track of all registered bodies, so voilá, easy as cake.</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">mapBodyManager.destroyPhysics();</code></pre></div>
<h3>Material system</h3>
<p>Those who are no strangers to Box2D will know that body&#x27;s fixtures have properties that determine how they interact with other entities. These are mainly: density, restitution and friction. Mass is usually determined by the area of the shape involved and the fixture&#x27;s density. Again, check out Box2D documentation for more details on this. We could just create all our static bodies with default properties but…</p>
<blockquote>
<p>I want to have icy, sandy and elastic surfaces in my game so characters can slide, be slower and bounce!</p>
</blockquote>
<p>How can our <em>MapBodyManager</em> deal with all this? It&#x27;s actually dead easy, I went for a very simple material system where each one of these materials are defined by a set of properties in a straightforward JSON file. Let&#x27;s say that the game world we want to model has regular, ice and elastic elements, we might be able to get away with something such as this.</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">[
  { &amp;quot;name&amp;quot; : &amp;quot;ice&amp;quot;, &amp;quot;density&amp;quot; : 1.0, &amp;quot;restitution&amp;quot; : 0.0, &amp;quot;friction&amp;quot; : 0.1 },
  { &amp;quot;name&amp;quot; : &amp;quot;elastic&amp;quot;, &amp;quot;density&amp;quot; : 1.0, &amp;quot;restitution&amp;quot; : 0.8, &amp;quot;friction&amp;quot; : 0.8 }
]</code></pre></div>
<p>Assigning materials to elements in our editor is also fairly simple. Add a <em>&quot;material&quot;</em> custom property per shape you want to behave in a non default manner. Every editor has its own GUI element for this and all of them are almost identical.</p>
<img class="mb-1" src="/img/wp/material.webp" alt="material.png"/>
<p>The <em>MapBodyManager</em> will automatically pick up each shape&#x27;s material and create bodies with the desired properties. Adding new materials is trivial and, whilst reassigning them is not comfortable, it&#x27;s not a deal breaker either.</p>
<p>This makes you happy, doesn&#x27;t it?</p>
<blockquote>
<p>Yay! ### Source code</p>
</blockquote>
<p>Did you read this all or did you just scrolled down after realising you could download the source at the end? If you belong to the first group, I have to say you&quot;re awesome and deserve my most sincere admiration.</p>
<p>Nevertheless, you&quot;ll be very disappointed to see there&#x27;s no arcane magic going on behind the scenes as the implementation is not shocking in any way. Here it goes for those who are bored enough and wouldn&#x27;t mind to procrastinate some more by reading a piece useless code.</p>
<p>As promised.</p>
<p><a class="text-contentLink text-lg" href="https://github.com/dsaltares/sioncore/blob/master/src/com/siondream/core/physics/MapBodyManager.java">MapBodyManager.java</a></p>
<p>To be honest, I&#x27;ve only tested this with Gleed created maps and I don&#x27;t intend to maintain this utility class any further than what I deem necessary to carry on with my projects. The API is homogeneous and should be fully compatible with Tiled and Tide as it is. Worst case scenario, if you bump into problems, the fixes are likely to be simple. Obviously, you&quot;re not forced to use it, feel free to mimic the approach and pick ideas from it, you&quot;ll probably come up with something better after some thought.</p>
<ul>
<li><strong>Edit 1</strong>: updated the code to support latest Libgdx API and fixed bugs.</li>
<li><strong>Edit 2</strong>: changed materials file format from XML to JSON.</li>
</ul></article></main></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"metadata":{"path":"content/post/2013-03-09-populate-your-box2d-world-using-the-libgdx-maps-api.mdx","title":"Populate your Box2D world using the libgdx maps API","date":"2013-03-09T18:51:12.000Z","categories":["Games development"],"series":null,"description":null,"slug":"populate-your-box2d-world-using-the-libgdx-maps-api","readingTime":"7 min read","draft":false,"disableComments":false,"keywords":[],"banner":null},"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h3: \"h3\",\n    a: \"a\",\n    img: \"img\",\n    blockquote: \"blockquote\",\n    em: \"em\",\n    div: \"div\",\n    pre: \"pre\",\n    code: \"code\",\n    ul: \"ul\",\n    li: \"li\",\n    strong: \"strong\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"This text proposes an effective approach to painlessly create static collidable geometry in 2D levels with the help of Box2D and the new libgdx maps API.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"All the source code is available for direct download below the post.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"New libgdx maps API\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The mighty libgdx library saw itself to yet another addition a couple of weeks ago, \", _jsx(_components.a, {\n        href: \"http://www.badlogicgames.com/wordpress/?p=2870\",\n        children: \"a shiny brand new maps API\"\n      }), \". Nex and me had been working on it for a while and people seem to be quite happy with it. Actually, by now, loads of folks have contributed too, which is kind of the beauty of open source, isn't it? You might as well read the \", _jsx(_components.a, {\n        href: \"http://code.google.com/p/libgdx/wiki/GraphicsTileMaps?ts=1361648294\u0026updated=GraphicsTileMaps\",\n        children: \"wiki page\"\n      }), \" and check out the \", _jsx(_components.a, {\n        href: \"https://code.google.com/p/libgdx/wiki/GraphicsTileMaps?ts=1361648294\u0026updated=GraphicsTileMaps#Examples\",\n        children: \"sample code\"\n      }), \", luckily enough, there's plenty which is not always the case.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"It primarily focuses on modelling how maps data is represented as well as in providing a way of easily implementing loaders and renderers for specific formats. The API comes with built in loaders and renderers for the \", _jsx(_components.a, {\n        href: \"http://www.mapeditor.org/\",\n        children: \"TMX\"\n      }), \", \", _jsx(_components.a, {\n        href: \"http://tide.codeplex.com/\",\n        children: \"Tide\"\n      }), \" and \", _jsx(_components.a, {\n        href: \"http://gleed2d.codeplex.com/\",\n        children: \"Gleed\"\n      }), \" formats. However, the latter might be deprecated at some point in the future due its absolute paths horribleness. Believe me, I've tried to work my way around it but there is just no elegant solution. Although there hasn't been any releases since it's inclusion, it's accessible in the \", _jsx(_components.a, {\n        href: \"http://libgdx.badlogicgames.com/nightlies/\",\n        children: \"nightly builds\"\n      }), \". For those interested in the implementation, please go to the Github repository.\"]\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/img/wp/maps-api-300x125.webp\",\n      alt: \"maps-api-300x125.png\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Take this cutie as an example, \", _jsx(_components.a, {\n        href: \"https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/superkoalio/SuperKoalio.java\",\n        children: \"a minimalistic platformer using the new API\"\n      }), \" in just under 300 lines.\"]\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/img/wp/koalio-300x216.webp\",\n      alt: \"koalio-300x216.png\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Enjoy.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Use your level editor to place world physics geometry\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's say you\\\"re working on a 2D game which mechanics require some sort of collision detection. Most likely, you\\\"ll be leveraging an editor such as Tiled or Gleed to boost your level creation process. How are you planning to implement collision detection in a way it doesn't become an excruciating pain in the ass to maintain? Can we also make it efficient, please?\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"At last! After all, this is what the article is really about.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you\\\"re going for tile based levels, you could add properties to the map to determine tiles walkability, a perfectly valid approach when presented with just a bunch of tiles. However, adding or changing tiles can become tedious really soon. Why don't you take advantage of Box2D collision detection algorithms and \", _jsx(_components.a, {\n        href: \"http://en.wikipedia.org/wiki/Space_partitioning\",\n        children: \"space partitioning\"\n      }), \" techniques? No worries, you could do so regardless of the need of running a real time physics simulation, just create the bodies, move them according to the game logic and query the world for intersections without stepping it. In case of dealing with a physics based game, then, by all means, make full use of Box2D.\"]\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/img/wp/tiled-caveman-300x154.webp\",\n      alt: \"tiled-caveman-300x154.png\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I\\\"m going to assume basic knowledge of this popular physics library, if you don't consider yourself minimally familiar with it, please \", _jsx(_components.a, {\n        href: \"http://box2d.org/manual.pdf\",\n        children: \"take some time to get the basics\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Alright, your textures are all set in your level and it looks stunningly beautiful! Sadly, you lack any kind of collision data. A good practice is to create a separate layer named \", _jsx(_components.em, {\n        children: \"\\\"physics\\\"\"\n      }), \" or similar for sanity reasons. Now you can start placing shapes (rectangles, circles, polygons or polylines) so they adjust to the non walkable areas. Here's an example in my WIP casual abduction game.\"]\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/img/wp/gleed-abduction-collisions-300x158.webp\",\n      alt: \"gleed-abduction-collisions-300x158.png\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"As you could have guessed, having thousands of shapes won't do your game's performance any favours. It\\\"d be a good idea to keep the shape count under control while preserving a decent granularity. Ideally, the editor would have a \", _jsx(_components.em, {\n        children: \"\\\"generate physics\\\"\"\n      }), \" option that would automatically create collision data from a texture layer using \", _jsx(_components.a, {\n        href: \"http://www.imageprocessingplace.com/downloads_V3/root_downloads/tutorials/contour_tracing_Abeer_George_Ghuneim/alg.html\",\n        children: \"contour tracing\"\n      }), \". Sadly, that's not the case in the state of the art open source software we have today.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Don't forget to hit \", _jsx(_components.em, {\n        children: \"\\\"save\\\"\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Create bodies from your level data \u003e My level has collidable static geometry data, how do I get that in my game?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"To tackle that problem I implemented a simple class named \", _jsx(_components.em, {\n        children: \"MapBodyManager\"\n      }), \" with the following interface.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"public class MapBodyManager {\\n    public MapBodyManager(World world, int unitsPerPixel, String materialsFile);\\n    public void createPhysics(Map map, String layerName);\\n    public void destroyPhysics();\\n}\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I believe it to be simple enough but I\\\"ll explain the details just in case. The constructor takes the Box2D world so it knows where to dump the new bodies into and where to delete them from later on. Most level editors work in pixels, while Box2D measures stuff in metres (take that imperial system!), hence the need for the \", _jsx(_components.em, {\n        children: \"unitsPerPixel\"\n      }), \" conversion rate. We\\\"ll get to the materials stuff in just a minute.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Once your level is loaded, you just need to do this.\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"MapBodyManager mapBodyManager = new MapBodyManager(world, 1.0f, Gdx.files.internal(\u0026quot;data/materials.json\u0026quot;));\\nMap map = assetManager.get(\u0026quot;data/level.xml\u0026quot;, Map.class);\\nmapBodyManager.createPhysics(map, \u0026quot;physics\u0026quot;);\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This will automatically create a static body per shape in your \", _jsx(_components.em, {\n        children: \"\\\"physics\\\"\"\n      }), \" layer as shown in the screenshot below.\"]\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/img/wp/abduction.webp\",\n      alt: \"abduction.jpg\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"So the player heroically beats the level and makes it to the next one. You surely will want to get rid of all those bodies (reference to murder not intended) before adding any more. Interestingly enough, our handy \", _jsx(_components.em, {\n        children: \"MapBodyManager\"\n      }), \" keeps track of all registered bodies, so voilá, easy as cake.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"mapBodyManager.destroyPhysics();\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Material system\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Those who are no strangers to Box2D will know that body's fixtures have properties that determine how they interact with other entities. These are mainly: density, restitution and friction. Mass is usually determined by the area of the shape involved and the fixture's density. Again, check out Box2D documentation for more details on this. We could just create all our static bodies with default properties but…\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"I want to have icy, sandy and elastic surfaces in my game so characters can slide, be slower and bounce!\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"How can our \", _jsx(_components.em, {\n        children: \"MapBodyManager\"\n      }), \" deal with all this? It's actually dead easy, I went for a very simple material system where each one of these materials are defined by a set of properties in a straightforward JSON file. Let's say that the game world we want to model has regular, ice and elastic elements, we might be able to get away with something such as this.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"[\\n  { \u0026quot;name\u0026quot; : \u0026quot;ice\u0026quot;, \u0026quot;density\u0026quot; : 1.0, \u0026quot;restitution\u0026quot; : 0.0, \u0026quot;friction\u0026quot; : 0.1 },\\n  { \u0026quot;name\u0026quot; : \u0026quot;elastic\u0026quot;, \u0026quot;density\u0026quot; : 1.0, \u0026quot;restitution\u0026quot; : 0.8, \u0026quot;friction\u0026quot; : 0.8 }\\n]\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Assigning materials to elements in our editor is also fairly simple. Add a \", _jsx(_components.em, {\n        children: \"\\\"material\\\"\"\n      }), \" custom property per shape you want to behave in a non default manner. Every editor has its own GUI element for this and all of them are almost identical.\"]\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/img/wp/material.webp\",\n      alt: \"material.png\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \", _jsx(_components.em, {\n        children: \"MapBodyManager\"\n      }), \" will automatically pick up each shape's material and create bodies with the desired properties. Adding new materials is trivial and, whilst reassigning them is not comfortable, it's not a deal breaker either.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This makes you happy, doesn't it?\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"Yay! ### Source code\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Did you read this all or did you just scrolled down after realising you could download the source at the end? If you belong to the first group, I have to say you\\\"re awesome and deserve my most sincere admiration.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Nevertheless, you\\\"ll be very disappointed to see there's no arcane magic going on behind the scenes as the implementation is not shocking in any way. Here it goes for those who are bored enough and wouldn't mind to procrastinate some more by reading a piece useless code.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"As promised.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.a, {\n        href: \"https://github.com/dsaltares/sioncore/blob/master/src/com/siondream/core/physics/MapBodyManager.java\",\n        children: \"MapBodyManager.java\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To be honest, I've only tested this with Gleed created maps and I don't intend to maintain this utility class any further than what I deem necessary to carry on with my projects. The API is homogeneous and should be fully compatible with Tiled and Tide as it is. Worst case scenario, if you bump into problems, the fixes are likely to be simple. Obviously, you\\\"re not forced to use it, feel free to mimic the approach and pick ideas from it, you\\\"ll probably come up with something better after some thought.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Edit 1\"\n        }), \": updated the code to support latest Libgdx API and fixed bugs.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Edit 2\"\n        }), \": changed materials file format from XML to JSON.\"]\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","scope":{}},"series":null},"__N_SSG":true},"page":"/[slug]","query":{"slug":"populate-your-box2d-world-using-the-libgdx-maps-api"},"buildId":"9JA16_iB_mzyhbFzPaViV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>