<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>

  <title>Continuous Delivery pipeline for Godot and itch.io &middot; David Saltares</title>

  
  <link rel="stylesheet" href="../css/poole.css">
  <link rel="stylesheet" href="../css/hyde.css">
  <link rel="stylesheet" href="../css/poole-overrides.css">
  <link rel="stylesheet" href="../css/hyde-overrides.css">
  <link rel="stylesheet" href="../css/hyde-x.css">
  <link rel="stylesheet" href="../css/highlight/zenburn.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../touch-icon-144-precomposed.png">
  <link href="../img/favicon.png" rel="icon">

  
  
  
  

  <meta name="description" content="">
  <meta name="keywords" content="">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-4440744-3', 'auto');
    ga('send', 'pageview');
  </script>
  

  
  <link rel="canonical" href="https://saltares.com/continuous-delivery-pipeline-for-godot-and-itch.io/" itemprop="url" />
</head>
<body>
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="../"><img src="../img/profile.jpg"
             alt="profile-picture" id="profile-img" title="David Saltares"></a>
      <h1><a href="../">David Saltares</a></h1>
      <p class="lead">Software Development</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="../">Blog</a></li>
      
      <li class="sidebar-nav-item"><a href="../about">About</a></li>
      
      <li class="sidebar-nav-item"><a href="../apps-tools">Apps &amp; Tools</a></li>
      
      <li class="sidebar-nav-item"><a href="../game-jams">Game Jams</a></li>
      
      <li class="sidebar-nav-item"><a href="../games">Games</a></li>
      
      <li class="sidebar-nav-item"><a href="../libgdx-cross-platform-game-development-cookbook">Libgdx Cookbook</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="http://github.com/dsaltares"><i class="fa fa-github-square fa-2x"></i></a>
      
      
      <a href="https://www.linkedin.com/in/davidsaltares"><i class="fa fa-linkedin-square fa-2x"></i></a>
      
      
      <a href="http://twitter.com/d_saltares"><i class="fa fa-twitter-square fa-2x"></i></a>
      <a href="https://www.youtube.com/channel/UCw375yUExJOVIEHmvmPFWyg"><i class="fa fa-youtube-square fa-2x"></i></a>
      <a href="../index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-2x"></i></a>
      </li>
    </ul>

    

    <div class="copyright">
      <p>
        &copy; 2021 David Saltares.<br/>
        Powered by <a href="http://gohugo.io">Hugo</a> and <a href="https://github.com/zyro/hyde-x">Hyde-X.</a><br/>
        Hosted on <a href="https://pages.github.com/">Github Pages</a>.
      </p>
    </div>
  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">Continuous Delivery pipeline for Godot and itch.io</h1>
    <span class="post-date">Mar 2, 2020 &middot; 5 minute read &middot; <a href="https://saltares.com/continuous-delivery-pipeline-for-godot-and-itch.io/#disqus_thread">Comments</a>
    
    <br/>
    <a class="label" href="../categories/games-development">Games Development</a>
    </span>
    <p>During the recent <a href="../plague-godot-wild-jam-18/">Godot Wild Jam 18</a>, I implemented a full <a href="https://en.wikipedia.org/wiki/Continuous_delivery">Continuous Delivery</a> system to automatically publish <a href="https://github.com/dsaltares/godot-wild-jam-18">Plague</a>, our entry, on <a href="https://itch.io/">itch.io</a>. The pipeline relies on Github Actions, the same <a href="easily-deploy-your-hugo-site-to-github-pages/">mechanism I use to build and deploy this very blog</a>.</p>
<p>Setting up your own is easy peasy and possibly free!</p>
<h3 id="-pipeline-overview">‚öíÔ∏è Pipeline overview</h3>
<ol>
<li>Someone pushes to the master branch on the remote repo.</li>
<li>The game is exported for all available platforms. In this case: Windows, Linux, MacOS and HTML5.</li>
<li>A new Github release is created with attached files, one per platform.</li>
<li>The release artifacts are pushed as new versions of the game to itch.io.</li>
</ol>
<p><a href="../img/cd-godot-itch/pipeline.png"><img src="../img/cd-godot-itch/pipeline.png" alt="pipeline"></a></p>
<h3 id="-configure-godot-exports">ü§ñ Configure Godot exports</h3>
<p>First, you need to setup the export settings in your Godot project. The <a href="https://docs.godotengine.org/en/3.2/getting_started/workflow/export/exporting_projects.html">official exporting guide</a> explains it perfectly. The thing to keep in mind here is that the preset name will determine the name of the published artifact. For example, a preset called <code>plague-mac</code> will result in a release with an attached file called <code>plague-mac.zip</code>.</p>
<p>In the case of our jam entry, we targeted MacOS, Windows, Linux and HTML5.</p>
<p><a href="../img/cd-godot-itch/godot-export-setup.gif"><img src="../img/cd-godot-itch/godot-export-setup.gif" alt="godot-export-setup"></a></p>
<h3 id="-export-the-game">üì¶ Export the game</h3>
<p>Create a <a href="https://github.com/dsaltares/godot-wild-jam-18/blob/master/.github/workflows/export_game.yaml"><code>.github/workflows/export_game.yaml</code></a> file in your repo. We will tell our new action to run on every push to master. We don&rsquo;t want new releases on commits that do not actually change the game. Our Godot project lives in the <code>game</code> folder, so we tell the action to only run if there are changes in that folder.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">on</span>:
  <span style="color:#f92672">push</span>:
    <span style="color:#f92672">branches</span>:
      - <span style="color:#ae81ff">master</span>
    <span style="color:#f92672">paths</span>:
      - <span style="color:#e6db74">&#39;game/**&#39;</span>
</code></pre></div><p>For the actual export step, we will leverage the <a href="https://github.com/firebelley/godot-export">Godot Export</a> Github action. The <a href="https://github.com/firebelley/godot-export/blob/master/README.md"><code>README.md</code></a> explains its usage very well.</p>
<p>For the action to work, you need to create a personal access token, which will give the export action write access to create a new release. First, <a href="https://github.com/settings/tokens">create a new token</a>. Then go to <code>https://github.com/&lt;org&gt;/&lt;repo&gt;/settings/secrets/new</code>, paste the key and name the secret <code>EXPORT_GITHUB_TOKEN</code>.</p>
<p>Here&rsquo;s our config in case it helps you. We setup the base version to be published, the links to download the Godot headless executable as well as the templates and tell it our project is located in the <code>game</code> folder in the repo.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">jobs</span>:
  <span style="color:#f92672">export_game</span>:
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>
    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Export game</span>
    <span style="color:#f92672">steps</span>:
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">checkout</span>
      <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v2.0.0</span>
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">export</span>
      <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">firebelley/godot-export@v1.1.0</span>
      <span style="color:#f92672">with</span>:
        <span style="color:#f92672">base_version</span>: <span style="color:#ae81ff">0.1.0</span>
        <span style="color:#f92672">godot_executable_download_url</span>: <span style="color:#ae81ff">https://downloads.tuxfamily.org/godotengine/3.2/Godot_v3.2-stable_linux_headless.64.zip</span>
        <span style="color:#f92672">godot_export_templates_download_url</span>: <span style="color:#ae81ff">https://downloads.tuxfamily.org/godotengine/3.2/Godot_v3.2-stable_export_templates.tpz</span>
        <span style="color:#f92672">godot_template_version</span>: <span style="color:#ae81ff">3.2</span><span style="color:#ae81ff">.stable</span>
        <span style="color:#f92672">relative_project_path</span>: <span style="color:#ae81ff">./game</span>
      <span style="color:#f92672">env</span>:
        <span style="color:#f92672">GITHUB_TOKEN</span>: <span style="color:#ae81ff">${{ secrets.EXPORT_GITHUB_TOKEN }}</span>
</code></pre></div><p>Whenever you push these changes to your repo, you should already start seeing <a href="https://github.com/dsaltares/godot-wild-jam-18/actions">jobs being triggered</a> and <a href="https://github.com/dsaltares/godot-wild-jam-18/releases">releases being published</a>.</p>
<p><a href="../img/cd-godot-itch/export-job.png"><img src="../img/cd-godot-itch/export-job.png" alt="export-job"></a></p>
<h3 id="-ship-the-game">üö¢ Ship the game</h3>
<p><a href="https://itch.io/docs/butler/">Butler</a> is the itch.io CLI, which lets you upload builds of your game. Our publish Github action will need to talk to itch.io using a valid API key. In order to get one, <a href="https://itch.io/docs/butler/installing.html">install butler</a> and <a href="https://itch.io/docs/butler/login.html#running-butler-from-ci-builds-travis-ci-gitlab-ci-etc">generate a key</a> via <code>butler login</code>. Refer to the docs for the details.</p>
<p>Then, copy your Butler API key and go to <code>https://github.com/org/repo/settings/secrets</code> and create a <code>BUTLER_CREDENTIALS</code> entry with the contents of the key.</p>
<p>Now create a <a href="https://github.com/dsaltares/godot-wild-jam-18/blob/master/.github/workflows/publish_game.yaml"><code>.github/workflows/publish_game.yaml</code></a> file in your repo. This action will run every time a new release is created or edited.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">on</span>:
  <span style="color:#f92672">release</span>:
    <span style="color:#f92672">types</span>: [<span style="color:#ae81ff">created, edited]</span>
</code></pre></div><p>Our workflow needs to contain a job per platform we want to publish. Each job will leverage the <a href="https://github.com/dsaltares/fetch-gh-release-asset">Fetch GH Release Asset</a> and <a href="https://github.com/josephbmanley/butler-publish-itchio-action">Butler Push</a> actions. We first download the latest release artifact for the platform we want to export and then we call the butler action to push the build to itch.io. When pushing multiple times to the <code>windows</code> <a href="https://itch.io/docs/butler/pushing.html#channel-names">channel</a>, each will be considered a new version of the same &ldquo;product.</p>
<p>Here you can use the <code>secrets.GITHUB_TOKEN</code>, which is automatically populated.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">jobs</span>:
  <span style="color:#f92672">release_windows</span>:
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>
    <span style="color:#f92672">steps</span>:
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">download widows</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">dsaltares/fetch-gh-release-asset@master</span>
        <span style="color:#f92672">with</span>:
          <span style="color:#f92672">file</span>: <span style="color:#ae81ff">plague-windows.zip</span>
        <span style="color:#f92672">env</span>:
          <span style="color:#f92672">GITHUB_TOKEN</span>: <span style="color:#e6db74">&#34;${{ secrets.GITHUB_TOKEN }}&#34;</span>
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">release windows</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">josephbmanley/butler-publish-itchio-action@master</span>
        <span style="color:#f92672">env</span>:
          <span style="color:#f92672">BUTLER_CREDENTIALS</span>: <span style="color:#ae81ff">${{ secrets.BUTLER_CREDENTIALS }}</span>
          <span style="color:#f92672">CHANNEL</span>: <span style="color:#ae81ff">windows</span>
          <span style="color:#f92672">ITCH_GAME</span>: <span style="color:#ae81ff">plague</span>
          <span style="color:#f92672">ITCH_USER</span>: <span style="color:#ae81ff">dsaltares</span>
          <span style="color:#f92672">PACKAGE</span>: <span style="color:#ae81ff">plague-windows.zip</span>
</code></pre></div><p>That&rsquo;s it! Once you push the publish workflow and make a change to the game, Github will export, create a new release and update your game on itch.io.</p>
<p><a href="../img/cd-godot-itch/publish-job.png"><img src="../img/cd-godot-itch/publish-job.png" alt="publish-job"></a></p>
<p>On your itch.io game page, you should see something like:</p>
<p><a href="../img/cd-godot-itch/itch-downloads.png"><img src="../img/cd-godot-itch/itch-downloads.png" alt="itch-downloads"></a></p>
<p>One last thing to remember is that you need to manually tag your HTML build as browser playable from the itch.io website as <a href="https://itch.io/docs/butler/pushing.html#html--playable-in-browser-games">specified in the Butler docs.</a>. You will only need to do this once as long as future HTML builds have the same channel.</p>
<h3 id="-advantages">‚úÖ Advantages</h3>
<ul>
<li>‚è≥ Automated. Do not waste time exporting your game regularly and updating various stores.</li>
<li>üöÄ Fast. Exporting and publishing for a jam sized game takes only 2 minutes.</li>
<li>üé• Restrospect. Check out how your game looked at an arbitrary point in the past without opening the editor.</li>
<li>üí∞ Cost effective. You get unlimited GH Actions minutes for open source projects and 3000 minutes for the Pro plan. That could easily equal 600 builds a month!</li>
<li>ü§∏ Flexible. No need to publish on every push, you can change the triggers to publish on every push to a <code>release</code> branch or simply on a fixed schedule.</li>
<li>üî≠ Extensible. Add jobs to publish to other stores or platforms.</li>
</ul>
<p>It would be amazing if you let me know your thoughts on this solution. Maybe you have a much better automated process or ideas on how to improve this one!</p>

  </div>
  <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'siondream';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>


<script src="../js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="../js/load-photoswipe.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
</body>
</html>

