<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/touch-icon-144-precomposed.png"/><title>ID generator, avoiding string comparisons · David Saltares</title><meta name="robots" content="index,follow"/><meta name="description" content="Engineering Leadership &amp; Software Development"/><meta property="og:title" content="ID generator, avoiding string comparisons · David Saltares"/><meta property="og:description" content="Engineering Leadership &amp; Software Development"/><meta property="og:url" content="https://saltares.com/id-generator-avoiding-string-comparisons"/><meta property="og:type" content="website"/><link rel="canonical" href="https://saltares.com/id-generator-avoiding-string-comparisons"/><meta name="keywords" content=""/><meta name="next-head-count" content="12"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/1e80e7c82199c580.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1e80e7c82199c580.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-24470d78cf61f77f.js" defer=""></script><script src="/_next/static/chunks/framework-9b5d6ec4444c80fa.js" defer=""></script><script src="/_next/static/chunks/main-e42aac98337d61c6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-89283805d41ea493.js" defer=""></script><script src="/_next/static/chunks/c16184b3-9b756f0214555638.js" defer=""></script><script src="/_next/static/chunks/2cca2479-c0f2c9f2f2dc1702.js" defer=""></script><script src="/_next/static/chunks/252-64d0c1a5eecbfabd.js" defer=""></script><script src="/_next/static/chunks/167-7d296999b3b0013a.js" defer=""></script><script src="/_next/static/chunks/962-68c39fb6207889be.js" defer=""></script><script src="/_next/static/chunks/673-8982310ab2fdaad5.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-d0bad99a4f6f3b56.js" defer=""></script><script src="/_next/static/x9Bugl6k5GYwZXjy9jmeZ/_buildManifest.js" defer=""></script><script src="/_next/static/x9Bugl6k5GYwZXjy9jmeZ/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=PT+Sans:wght@400;700&display=swap">@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79P0Y.woff) format('woff')}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh4Oo.woff) format('woff')}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0-ExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0aExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0yExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0KExcOPIDU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0OOtLR8a8zILig.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0OqtLR8a8zILig.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0OCtLR8a8zILig.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'PT Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0O6tLR8a8zI.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="flex flex-col md:flex-row font-sans text-xl w-full"><aside class="md:max-w-[360px] bg-primary px-10 py-10 text-white text-xl md:fixed md:top-0 md:left-0 md:h-full flex flex-col justify-end items-center md:items-start"><div><a href="/"><div class="mb-5"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27200%27%20height=%27200%27/%3e"/></span><img alt="profile picture" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="profile picture" src="/img/profile.webp" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="rounded-full" loading="lazy"/></noscript></span></div><h1 class="text-white font-bold text-4xl leading-10">David Saltares</h1></a></div><p class="text-contentLight text-2xl mb-5 leading-9 text-center md:text-left">Engineering Leadership &amp; Software Development</p><a href="https://tinyletter.com/dsaltares/"><p class="mb-5">✉️ Subscribe</p></a><nav><ul class="mb-5 flex flex-col items-center md:items-start list-none pl-0"><li class="leading-7"><a href="/">Blog</a></li><li class="leading-7"><a href="/about-me/">About</a></li><li class="leading-7"><a href="/apps-tools/">Apps &amp; Tools</a></li><li class="leading-7"><a href="/game-jams/">Game Jams</a></li><li class="leading-7"><a href="/games/">Games</a></li><li class="leading-7"><a href="/libgdx-cross-platform-game-development-cookbook/">Libgdx Cookbook</a></li></ul></nav><ul class="mb-5 list-none pl-0"><li class="inline"><a aria-label="Github profile" href="https://github.com/dsaltares"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="square-github" class="svg-inline--fa fa-square-github text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg></a></li><li class="inline"><a aria-label="Linkedin profile" href="https://www.linkedin.com/in/davidsaltares/"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li class="inline"><a aria-label="Twitter profile" href="https://twitter.com/dsaltares"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="square-twitter" class="svg-inline--fa fa-square-twitter text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-48.9 158.8c.2 2.8.2 5.7.2 8.5 0 86.7-66 186.6-186.6 186.6-37.2 0-71.7-10.8-100.7-29.4 5.3.6 10.4.8 15.8.8 30.7 0 58.9-10.4 81.4-28-28.8-.6-53-19.5-61.3-45.5 10.1 1.5 19.2 1.5 29.6-1.2-30-6.1-52.5-32.5-52.5-64.4v-.8c8.7 4.9 18.9 7.9 29.6 8.3a65.447 65.447 0 0 1-29.2-54.6c0-12.2 3.2-23.4 8.9-33.1 32.3 39.8 80.8 65.8 135.2 68.6-9.3-44.5 24-80.6 64-80.6 18.9 0 35.9 7.9 47.9 20.7 14.8-2.8 29-8.3 41.6-15.8-4.9 15.2-15.2 28-28.8 36.1 13.2-1.4 26-5.1 37.8-10.2-8.9 13.1-20.1 24.7-32.9 34z"></path></svg></a></li><li class="inline"><a aria-label="RSS feed" href="https://saltares.com/index.xml"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="square-rss" class="svg-inline--fa fa-square-rss text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm64 120c0 17.7-14.3 32-32 32s-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32z"></path></svg></a></li><li class="inline"><a rel="me" href="https://fosstodon.org/@dsaltares"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="mastodon" class="svg-inline--fa fa-mastodon text-4xl mr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></path></svg></a></li></ul><p class="text-contentLight text-lg">© 2023 David Saltares.</p></aside><div class="md:max-w-[360px] w-full hidden md:block flex-grow-0 flex-shrink-0"></div><div class="flex flex-col main-content"><main class="w-full max-w-[720px] pr-4 py-10 pl-5 md:py-20 md:pl-20"><article class="text-content mb-10"><div><a href="/id-generator-avoiding-string-comparisons/"><h1 class="font-bold text-4xl mb-2 text-primary">ID generator, avoiding string comparisons</h1></a><p class="flex text-contentLight mb-1">Sep 9 2012 · 4 min read<span> · </span><a class="text-contentLink" href="/id-generator-avoiding-string-comparisons/#disqus_thread">Comments</a></p><div class="mb-3"><div class="flex flex-row gap-1"><a class="px-2 py-1 bg-slate-900 text-white rounded font-bold text-sm" href="/categories/games-development/">Games development</a><a class="px-2 py-1 bg-slate-900 text-white rounded font-bold text-sm" href="/categories/projects/">Projects</a></div></div></div><img class="mb-1" src="/img/wp/stringcomparesarebade.webp" alt="stringcomparesarebade.png"/>
<p><strong>Disclaimer</strong>: IDGenerator is being used in <a class="text-contentLink text-lg" href="https://github.com/dsaltares/sionengine"><strong>SionEngine</strong></a> and it&#x27;s an useful but rather simple approach to the problem described in the paragraphs below.</p>
<p>Needless to say that <strong>in games development we care very much about performance</strong>. It becomes an even more critical issue when we&quot;re dealing with non native languages such as Python, C# or Java (being the later my case in these dire times). One of the countless things that can negatively impact performance in games are strings comparisons. They are bad, slow, nasty pieces of code, specially when placed inside the main loop.</p>
<h3>Sometimes they&quot;re needed!</h3>
<p>But sometimes they&quot;re needed! A little person shouts in the crowd. Let&#x27;s say we define our character&#x27;s animations in an XML file the following way.</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;sprite name=&amp;quot;data/character.png&amp;quot;
	      frameDuration=&amp;quot;0.03333&amp;quot;
	      rows=&amp;quot;7&amp;quot;
	      columns=&amp;quot;8&amp;quot; &amp;gt;

	&amp;lt;animation name=&amp;quot;idle&amp;quot; mode=&amp;quot;loop&amp;quot; frames=&amp;quot;0-13&amp;quot; /&amp;gt;
	&amp;lt;animation name=&amp;quot;walk&amp;quot; mode=&amp;quot;loop&amp;quot; frames=&amp;quot;14-39&amp;quot; /&amp;gt;
	&amp;lt;animation name=&amp;quot;jump&amp;quot; mode=&amp;quot;normal&amp;quot; frames=&amp;quot;40-55&amp;quot; /&amp;gt;
&amp;lt;/sprite&amp;gt;</code></pre></div>
<p>It&#x27;s natural to use strings to name our animations, they&quot;re human readable and comfy but again, expensive to work with. Our character will want to change animation from time to time and the code for that could be something like:</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">caveman.setAnimation(&amp;quot;walk&amp;quot;);</code></pre></div>
<p>The <em>setAnimation()</em> method has to look into its map, performing <em>log(n)</em> ugly string comparisons to find the right animation. We&quot;re righteous game programmers and that makes us sad.</p>
<h3>Working our way around string comparisons</h3>
<p>Well, in that case we&quot;d want to use an alternative method. It&quot;d be nice to be able to numerically identify a string in the global scope of our game, so when we have two generated IDs we could just compare them. That&#x27;s very cheap, yay! ID generation and retrieval might not be lightning fast but that would only be performed during start up or once in a while, definitely not in the very middle of our game loop.</p>
<p>The first approach that someone might come up with are <strong><a class="text-contentLink text-lg" href="http://en.wikipedia.org/wiki/Hash_function">hashes</a></strong> which basically turn a string into a number. The problem being: if the string is fairly big and you&quot;re unlucky, you may end up having the same hash code for two different strings and you don&#x27;t want that, do you? Pretty sure some funny to hunt bug will be the result of such thing.</p>
<p>We are most definitely not going to use all the infinite strings in the world so we could <strong>generate new IDs for them as they&quot;re needed</strong>. Obviously, when we find two IDs generated from the same string, we&quot;d like them to be equal. Our solution would have to keep track of the strings that have already been identified and return the same ID when it&#x27;s requested again. Easy peasy.</p>
<h3>A simple but decent solution: <em>IDGenerator</em></h3>
<p>This might not be the most intelligent implementation for the present problem, however it certainly serves the purpose of the post. Our IDGenerator has two static public methods:</p>
<ul>
<li><strong><em>getID()</em></strong>: given a string, returns its ID. Creates a new one if it didn&#x27;t exist. * <em><strong>getString()</strong></em>: given an ID, return its original string. Returns the string representation of the ID if it wasn&#x27;t registered.</li>
</ul>
<p>To do so, it has a <em>HashMap</em> using strings as keys. ID retrieval ends up being logarithmic whereas name checks are linear. I&#x27;ve gone for this approach because the second operation is much less likely to be executed than the first one except to make IDs human readable for the poor coder who&#x27;s debugging our crappy work in logging methods.</p>
<p>Here&#x27;s the <em>&quot;beauty&quot;</em> in question.</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">public class IDGenerator {
	private static int m_next = 1;
	private static HashMap&amp;lt;string , Integer&amp;gt; m_ids = new HashMap&amp;lt;string , Integer&amp;gt;();

	public static int getID(String string) {
		Integer id = m_ids.get(string);

		if (id == null) {
			id = m_next;
			m_ids.put(string, m_next++);
		}

		return id;
	}

	public static String getString(int id) {
		Iterator&amp;lt;entry &amp;lt;String, Integer&amp;gt;&amp;gt; it = m_ids.entrySet().iterator();

		while (it.hasNext()) {
			Entry&amp;lt;string , Integer&amp;gt; entry = it.next();

			if (entry.getValue() == id) {
				return entry.getKey();
			}
		}

		return null;
	}
}</code></pre></div>
<h3>Example of use</h3>
<p>Sticking to our previous animation example, our character could cache its animations right in its constructor this way. <strong>Once!</strong></p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">private static final int m_idle = IDGenerator.getID(&amp;quot;idle&amp;quot;);
private static final int m_walk = IDGenerator.getID(&amp;quot;walk&amp;quot;);
private static final int m_jump = IDGenerator.getID(&amp;quot;jump&amp;quot;);</code></pre></div>
<p>Now, at the time of picking an animation we use an int instead of a string and therefore, a beautiful smile is drawn on our faces.</p>
<div class="remark-highlight"><pre class="language-unknown"><code class="language-unknown">caveman.setAnimation(m_walk);</code></pre></div>
<p>Of course, this can be extensively use in your project, hope it helps. By the way, know than more and hopefully better is yet to come.</p></article></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"metadata":{"path":"content/post/2012-09-09-id-generator-avoiding-string-comparisons.mdx","title":"ID generator, avoiding string comparisons","date":"2012-09-09T19:58:44.000Z","categories":["Games development","Projects"],"series":null,"description":null,"slug":"id-generator-avoiding-string-comparisons","readingTime":"4 min read","draft":false,"disableComments":false,"keywords":[],"banner":null},"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    img: \"img\",\n    p: \"p\",\n    strong: \"strong\",\n    a: \"a\",\n    h3: \"h3\",\n    div: \"div\",\n    pre: \"pre\",\n    code: \"code\",\n    em: \"em\",\n    ul: \"ul\",\n    li: \"li\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.img, {\n      src: \"/img/wp/stringcomparesarebade.webp\",\n      alt: \"stringcomparesarebade.png\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Disclaimer\"\n      }), \": IDGenerator is being used in \", _jsx(_components.a, {\n        href: \"https://github.com/dsaltares/sionengine\",\n        children: _jsx(_components.strong, {\n          children: \"SionEngine\"\n        })\n      }), \" and it's an useful but rather simple approach to the problem described in the paragraphs below.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Needless to say that \", _jsx(_components.strong, {\n        children: \"in games development we care very much about performance\"\n      }), \". It becomes an even more critical issue when we\\\"re dealing with non native languages such as Python, C# or Java (being the later my case in these dire times). One of the countless things that can negatively impact performance in games are strings comparisons. They are bad, slow, nasty pieces of code, specially when placed inside the main loop.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Sometimes they\\\"re needed!\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"But sometimes they\\\"re needed! A little person shouts in the crowd. Let's say we define our character's animations in an XML file the following way.\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\\n\u0026lt;sprite name=\u0026quot;data/character.png\u0026quot;\\n\\t      frameDuration=\u0026quot;0.03333\u0026quot;\\n\\t      rows=\u0026quot;7\u0026quot;\\n\\t      columns=\u0026quot;8\u0026quot; \u0026gt;\\n\\n\\t\u0026lt;animation name=\u0026quot;idle\u0026quot; mode=\u0026quot;loop\u0026quot; frames=\u0026quot;0-13\u0026quot; /\u0026gt;\\n\\t\u0026lt;animation name=\u0026quot;walk\u0026quot; mode=\u0026quot;loop\u0026quot; frames=\u0026quot;14-39\u0026quot; /\u0026gt;\\n\\t\u0026lt;animation name=\u0026quot;jump\u0026quot; mode=\u0026quot;normal\u0026quot; frames=\u0026quot;40-55\u0026quot; /\u0026gt;\\n\u0026lt;/sprite\u0026gt;\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It's natural to use strings to name our animations, they\\\"re human readable and comfy but again, expensive to work with. Our character will want to change animation from time to time and the code for that could be something like:\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"caveman.setAnimation(\u0026quot;walk\u0026quot;);\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \", _jsx(_components.em, {\n        children: \"setAnimation()\"\n      }), \" method has to look into its map, performing \", _jsx(_components.em, {\n        children: \"log(n)\"\n      }), \" ugly string comparisons to find the right animation. We\\\"re righteous game programmers and that makes us sad.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Working our way around string comparisons\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Well, in that case we\\\"d want to use an alternative method. It\\\"d be nice to be able to numerically identify a string in the global scope of our game, so when we have two generated IDs we could just compare them. That's very cheap, yay! ID generation and retrieval might not be lightning fast but that would only be performed during start up or once in a while, definitely not in the very middle of our game loop.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The first approach that someone might come up with are \", _jsx(_components.strong, {\n        children: _jsx(_components.a, {\n          href: \"http://en.wikipedia.org/wiki/Hash_function\",\n          children: \"hashes\"\n        })\n      }), \" which basically turn a string into a number. The problem being: if the string is fairly big and you\\\"re unlucky, you may end up having the same hash code for two different strings and you don't want that, do you? Pretty sure some funny to hunt bug will be the result of such thing.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We are most definitely not going to use all the infinite strings in the world so we could \", _jsx(_components.strong, {\n        children: \"generate new IDs for them as they\\\"re needed\"\n      }), \". Obviously, when we find two IDs generated from the same string, we\\\"d like them to be equal. Our solution would have to keep track of the strings that have already been identified and return the same ID when it's requested again. Easy peasy.\"]\n    }), \"\\n\", _jsxs(_components.h3, {\n      children: [\"A simple but decent solution: \", _jsx(_components.em, {\n        children: \"IDGenerator\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This might not be the most intelligent implementation for the present problem, however it certainly serves the purpose of the post. Our IDGenerator has two static public methods:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: _jsx(_components.em, {\n            children: \"getID()\"\n          })\n        }), \": given a string, returns its ID. Creates a new one if it didn't exist. * \", _jsx(_components.em, {\n          children: _jsx(_components.strong, {\n            children: \"getString()\"\n          })\n        }), \": given an ID, return its original string. Returns the string representation of the ID if it wasn't registered.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"To do so, it has a \", _jsx(_components.em, {\n        children: \"HashMap\"\n      }), \" using strings as keys. ID retrieval ends up being logarithmic whereas name checks are linear. I've gone for this approach because the second operation is much less likely to be executed than the first one except to make IDs human readable for the poor coder who's debugging our crappy work in logging methods.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Here's the \", _jsx(_components.em, {\n        children: \"\\\"beauty\\\"\"\n      }), \" in question.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"public class IDGenerator {\\n\\tprivate static int m_next = 1;\\n\\tprivate static HashMap\u0026lt;string , Integer\u0026gt; m_ids = new HashMap\u0026lt;string , Integer\u0026gt;();\\n\\n\\tpublic static int getID(String string) {\\n\\t\\tInteger id = m_ids.get(string);\\n\\n\\t\\tif (id == null) {\\n\\t\\t\\tid = m_next;\\n\\t\\t\\tm_ids.put(string, m_next++);\\n\\t\\t}\\n\\n\\t\\treturn id;\\n\\t}\\n\\n\\tpublic static String getString(int id) {\\n\\t\\tIterator\u0026lt;entry \u0026lt;String, Integer\u0026gt;\u0026gt; it = m_ids.entrySet().iterator();\\n\\n\\t\\twhile (it.hasNext()) {\\n\\t\\t\\tEntry\u0026lt;string , Integer\u0026gt; entry = it.next();\\n\\n\\t\\t\\tif (entry.getValue() == id) {\\n\\t\\t\\t\\treturn entry.getKey();\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\treturn null;\\n\\t}\\n}\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Example of use\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Sticking to our previous animation example, our character could cache its animations right in its constructor this way. \", _jsx(_components.strong, {\n        children: \"Once!\"\n      })]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"private static final int m_idle = IDGenerator.getID(\u0026quot;idle\u0026quot;);\\nprivate static final int m_walk = IDGenerator.getID(\u0026quot;walk\u0026quot;);\\nprivate static final int m_jump = IDGenerator.getID(\u0026quot;jump\u0026quot;);\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now, at the time of picking an animation we use an int instead of a string and therefore, a beautiful smile is drawn on our faces.\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"caveman.setAnimation(m_walk);\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Of course, this can be extensively use in your project, hope it helps. By the way, know than more and hopefully better is yet to come.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","scope":{}},"series":null},"__N_SSG":true},"page":"/[slug]","query":{"slug":"id-generator-avoiding-string-comparisons"},"buildId":"x9Bugl6k5GYwZXjy9jmeZ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>