{"pageProps":{"metadata":{"path":"content/post/2012-09-08-abstracting-platform-specific-code-in-libgdx.mdx","title":"Abstracting platform specific code in libgdx","date":"2012-09-08T11:02:59.000Z","categories":["Games development"],"series":null,"description":null,"slug":"abstracting-platform-specific-code-in-libgdx","readingTime":"3 min read","draft":false,"disableComments":false,"keywords":[]},"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    em: \"em\",\n    h3: \"h3\",\n    ul: \"ul\",\n    li: \"li\",\n    strong: \"strong\",\n    code: \"code\",\n    div: \"div\",\n    pre: \"pre\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"One of the main reasons I\\\"m working with \", _jsx(_components.a, {\n        href: \"http://libgdx.badlogicgames.com/\",\n        children: \"libgdx\"\n      }), \" is its multiplatform capabilities. With very little effort you can target desktop (Windows/Linux/Mac), Android and WebGL able browsers. The problem comes with the \", _jsx(_components.em, {\n        children: \"\\\"little\\\"\"\n      }), \" in the previous sentence. The developer is supposed to share the code base between all targets but sometimes it\\\"s necessary to provide platform specific behaviour, maybe because a feature is not available in every device or just to adapt the product better to the target. Anyway, how do we achieve that in a fairly elegant fashion?\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Project structure\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"As many of you may already know, a multiplatform libgdx project is often arranged the following way:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"game\"\n        }), \": shared code base\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"game-desktop\"\n        }), \": desktop launcher\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"game-android\"\n        }), \": Android launcher\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"game-html\"\n        }), \": HTML5 launcher\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Every platform specific project depends on the base one and they all instantiate the main class from there, typically belonging to an \", _jsx(_components.code, {\n        children: \"ApplicationListener\"\n      }), \" derived class (we shall name it \", _jsx(_components.em, {\n        children: \"Game\"\n      }), \" from now on). Yes, it is perfectly fine to add platform specific code in the derived projects. However, it would be desirable to handle platform specific behaviour using an homogeneous approach, from our base project.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"The PlatformResolver interface\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This interface belongs to the shared code base and it contains methods to provide platform specific behaviour depending on our needs. Here there\\\"s just a very basic example but this interface could vary on a per game basis. A good idea would be to implement this class as a \", _jsx(_components.a, {\n        href: \"http://en.wikipedia.org/wiki/Facade_pattern\",\n        children: \"Facade\"\n      }), \" providing access to platform specific subsystems such as input management or Facebook connectivity to mention a couple.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"public interface PlatformResolver {\\n    public String getDefaultLanguage();\\n    public FacebookAPI getFacebookAPI();\\n    public InputManager getInputManager();\\n}\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Our main game class would hold an instance to a specific \", _jsx(_components.em, {\n        children: \"PlatformResolver\"\n      }), \" yet to be determined. It\\\"s each platform\\\"s responsibility to tell the game which instance should it use to solve platform specific issues.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"public class Game implements ApplicationListener {\\n    protected static PlatformResolver m_platformResolver = null;\\n\\n    public static PlatformResolver getPlatformResolver() {\\n        return m_platformResolver;\\n    }\\n\\n    public static void setPlatformResolver(PlatformResolver platformResolver) {\\n        m_platformResolver = platformResolver;\\n    }\\n}\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"PlatformResolver in use\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In each descendent project we would have something similar to:\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"public class AndroidResolver implements PlatformResolver {}\\npublic class DesktopResolver implements PlatformResolver {}\\npublic class WebGLResolver implements PlatformResolver {}\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Like I mentioned before, it\\\"s necessary to tell the \", _jsx(_components.em, {\n        children: \"Game\"\n      }), \" which platform resolver to use, we do that in every platform\\\"s launcher. The desktop one could serve as a perfectly valid example:\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"public static void main(String[] args) {\\n    // Configure platform dependent code\\n    Game.setPlatformResolver(new DesktopResolver());\\n\\n    // Launch the game\\n    new LwjglApplication(new Game(), cfg);\\n}\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Later on during execution we could need to determine the system\\\"s default language but that depends on the platform we are working withâ€¦ Fear no more! We can happily ask our \", _jsx(_components.em, {\n        children: \"PlatformResolver\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"String defaultLang = Game.getPlatformResolver().getDefaultLanguage();\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"The possibilities\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We are currently using this very same approach for \", _jsx(_components.a, {\n        href: \"https://github.com/dsaltares/sionengine\",\n        children: \"SionEngine\"\n      }), \" and it\\\"s proven to be flawless so far. You can abstract virtually any platform specific behaviour using something similar.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Soon there will be more and better on libgdx related stuff! Feel free to criticize and throw rocks at me because of this post.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","scope":{}},"series":null},"__N_SSG":true}