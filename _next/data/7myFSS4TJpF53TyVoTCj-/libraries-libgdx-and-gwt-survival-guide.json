{"pageProps":{"metadata":{"path":"content/post/2013-04-11-libraries-libgdx-and-gwt-survival-guide.mdx","title":"Libraries, libgdx and GWT survival guide","date":"2013-04-11T07:21:25.000Z","categories":["Games development"],"series":null,"description":null,"slug":"libraries-libgdx-and-gwt-survival-guide","readingTime":"6 min read","draft":false,"disableComments":false,"keywords":[],"banner":null},"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    blockquote: \"blockquote\",\n    h3: \"h3\",\n    img: \"img\",\n    em: \"em\",\n    div: \"div\",\n    pre: \"pre\",\n    code: \"code\",\n    strong: \"strong\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"As of today, I truly believe libgdx to be the best open source cross platform games framework when it comes to 2D. As if desktop, Android and iOS were not enough, it also comes with a WebGL backend. Luckily enough, this does not force you to maintain a Javascript version of your game code. Instead, it relies on \", _jsx(_components.a, {\n        href: \"https://developers.google.com/web-toolkit/\",\n        children: \"Google Web Toolkit (GWT)\"\n      }), \", which translates your Java project into optimized, obfuscated Javascript code.\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"OMG. How does this work?\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Black, arcane magic. I would presume it sacrifices a dozen virgins during the third full moon of the year to make it happen. Just don't ask.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Considerable win? Yes. Silver bullet? No.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This is utterly awesome for obvious reasons. Only, an insignificant amount of extra code is needed for your games to be fully playable from any WebGL browser without requiring any extra plugins. Take that Flash, Unity and the like!\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"However, as they say, not everything that glitters is gold. GWT doesn't support every Java feature and this could potentially be a deal breaker depending on your existing codebase. Moreover, you could get unlucky and find out that the library that was about to make your life so much easier is not GWT friendly. Damn!\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Last weekend, I was doing some work with libgdx that absolutely required browser compatibility. I happened to need a way of automatically placing tree nodes on a 2D surface. A smile was drawn on my face when I found the sexy \", _jsx(_components.a, {\n        href: \"https://code.google.com/p/treelayout/\",\n        children: \"treelayout\"\n      }), \" library. Of course, it couldn't be that easy, there's no joy in victory when it hasn't been preceded by some pain. I had to adapt it to the GWT build process and fix a few compatibility issues.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"If anything, this made me realise that including new Java libraries in your WebGL libgdx game is not so straightforward. Hence, this small survival guide.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"If you\\\"re lucky, Setup UI\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Chances are, you've setted up your project using the magnificent \", _jsx(_components.a, {\n        href: \"http://www.aurelienribon.com/blog/2012/09/libgdx-project-setup-v3-0-0/\",\n        children: \"Setup UI\"\n      }), \" tool. Aurelien Ribon's free tool automatically creates cross platform libgdx Eclipse projects, including the libraries you want. Even though it has a system to add optional third party libraries, only a couple of them are available at the minute.\"]\n    }), \"\\n\", _jsx(_components.img, {\n      src: \"/img/wp/gdx-setup-ui-3-RC-02.webp\",\n      alt: \"gdx-setup-ui-3-RC-02-300x163.jpg\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Long story short. As long as that external library you want is either Universal Tween Engine or Physics Body Editor loader, you\\\"re good. Otherwise, read on, as you might have some work down the road. Hopefully, this situation will change in the future.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"GWT build process 101\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Bare in mind this is a guide so you can fix your library problem and move on, those who seek a proper explanation, I\\\"d recommend \", _jsx(_components.a, {\n        href: \"https://developers.google.com/web-toolkit/doc/latest/DevGuideOrganizingProjects\",\n        children: \"the official documentation\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's get going! You will find a very special file named \", _jsx(_components.em, {\n        children: \"GwtDefinition.gwt.xml\"\n      }), \" under the main package folder in the HTML5 project. It\\\"ll look something like this.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;\\n&lt;module&gt;\\n    &lt;entry-point class=&quot;com.siondream.mygame.client.GwtLauncher&quot;/&gt;\\n    &lt;set-configuration-property name=&quot;gdx.assetpath&quot; value=&quot;../tranches-android/assets&quot;/&gt;\\n    &lt;inherits name=&quot;MyGame&quot;/&gt;\\n    &lt;inherits name=&quot;aurelienribon.tweenengine&quot;/&gt;\\n    &lt;inherits name=&quot;com.badlogic.gdx.backends.gdx_backends_gwt&quot;/&gt;\\n&lt;/module&gt;\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Its main purpose is to tell the GTW compiler what modules the application depends on, and therefore, inherits from. As you can see, it's also used to specify the entry point class and add configuration params such as the assets folder location. I've obviously made \", _jsx(_components.em, {\n        children: \"MyGame\"\n      }), \" module up, this would correspond to your core project. Look under the src folder of your core project and you should find a \", _jsx(_components.em, {\n        children: \"MyGame.gwt.xml\"\n      }), \" file.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\\n&lt;!DOCTYPE module PUBLIC &quot;-//Google Inc.//DTD Google Web Toolkit trunk//EN&quot; &quot;http://google-web-toolkit.googlecode.com/svn/trunk/distro-source/core/src/gwt-module.dtd&quot;&gt;\\n&lt;module&gt;\\n\\t&lt;source path=&quot;com/siondream/mygame&quot; /&gt;\\n&lt;/module&gt;\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"As you can see, the \", _jsx(_components.em, {\n        children: \"MyGame\"\n      }), \" module contains a single source path which is located under the \", _jsx(_components.em, {\n        children: \"com.siondream.mygame\"\n      }), \" package. If you wanted, you could add more source path entries in this file as long as they point to packages under the same project.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now you\\\"re a GWT expert, right?\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Integrating a third party library\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"It's not hard to guess what you need to add an external library to your GWT build process. You've guessed right, it's necessary to add a new module inheritance entry in your \", _jsx(_components.em, {\n        children: \"GwtDefinitions.xml\"\n      }), \" file that points to a module file, which in turn, points to where the source code is.\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"Does that mean that I can't get away with just adding a third party jar to the build path?\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Exactly. This is a bit of a downside because it requires you to import the whole library source into your workspace, and that means you need to be able to access the source in the first place.\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"Crap!\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Well, it's actually not too bad. In my particular case, I went to the treelayout Google Code repository, checked out the source using Tortoise SVN and imported the project, easy peasy. The next step would be to add a module definition file under the src folder in the treelayout project, let's name it \", _jsx(_components.em, {\n        children: \"TreeLayout.gwt.xml\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\\n&lt;!DOCTYPE module PUBLIC &quot;-//Google Inc.//DTD Google Web Toolkit trunk//EN&quot; &quot;http://google-web-toolkit.googlecode.com/svn/trunk/distro-source/core/src/gwt-module.dtd&quot;&gt;\\n&lt;module&gt;\\n\\t&lt;source path=&quot;org/abego/treelayout&quot; /&gt;\\n&lt;/module&gt;\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Hang on, we\\\"re almost there! Finally, add the inheritance entry to the \", _jsx(_components.em, {\n        children: \"GwtDefinitions.xml\"\n      }), \" file.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;\\n&lt;module&gt;\\n    &lt;entry-point class=&quot;com.siondream.tranches.client.GwtLauncher&quot;/&gt;\\n    &lt;set-configuration-property name=&quot;gdx.assetpath&quot; value=&quot;../tranches-android/assets&quot;/&gt;\\n    &lt;inherits name=&quot;MyGame&quot;/&gt;\\n    &lt;inherits name=&quot;TreeLayout&quot;/&gt;\\n    &lt;inherits name=&quot;aurelienribon.tweenengine&quot;/&gt;\\n    &lt;inherits name=&quot;com.badlogic.gdx.backends.gdx_backends_gwt&quot;/&gt;\\n&lt;/module&gt;\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Done! If you take 10 minutes to offer some prayers to \", _jsx(_components.em, {\n        children: \"$deity\"\n      }), \" and press GWT everything should just work.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Note\"\n      }), \": after someone saying, \", _jsx(_components.em, {\n        children: \"\\\"it just should just work\\\"\"\n      }), \", I've come to realise that such situation is hardly ever the case.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Errors, expect them\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Before carrying on with this section, I would always recommend to add these options to the GWT compiler.\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"-optimize 9 -strict\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Optimize speaks for itself but strict means that the build process will bail out as soon as it encounters an error, rather than trying to keep going.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"As long as you've followed the process, your library should be detected by the GWT compiler. However, like I've said before, \", _jsx(_components.a, {\n        href: \"https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsCompatibility\",\n        children: \"GWT doesn't support every Java feature\"\n      }), \". Every time you use an unsupported class or method you\\\"ll get an error that looks like the following one.\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"remark-highlight\",\n      children: _jsx(_components.pre, {\n        className: \"language-unknown\",\n        children: _jsx(_components.code, {\n          className: \"language-unknown\",\n          children: \"[ERROR] Line 84: No source code is available for type java.util.Formatter; did you forget to inherit a required module?\"\n        })\n      })\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"This is going to hurt, isn't it?\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Again, GWT is not a silver bullet but it generally does a pretty good job. To tackle these issues you could try replacing every problematic class usage or method call by an equivalent, or an alternative of your own. Fear not, most Java stuff is there, the common troublesome areas I've come across are reflection, AWT and String.format().\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Off you go\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"These steps helped me with treelayout integration and I hope they can aid you too. In my case I had to go through them all as the library used unsupported features. We\\\"re done here, feel free to comment with your own experiences. Also, if you find any errors in the text, please point it out so it can be promptly fixed.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","scope":{}},"series":null},"__N_SSG":true}